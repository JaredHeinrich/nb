#compdef nb

NB_ROOT_DIR="$HOME/.notebooks"

_nb() {
    local state line
    _arguments -C \
        '--help[Print help]' \
        '--version[Print version]' \
        "1:subcommand:_nb_subcommands" \
        "*::arg:->args"
    case $line[1] in
        (new)
            _arguments \
                ':name -- Name of the note book to be created.:_default' \
            ;;
        (open)
            _arguments \
                '::name -- Name of the note book to open.:_nb_notebooks' \
            ;;
        (remove)
            _arguments \
                ':name -- Name of the note book to be deleted.:_nb_notebooks' \
            ;;
        (rm)
            _arguments \
                ':name -- Name of the note book to be deleted.:_nb_notebooks' \
            ;;
        (completions)
            _arguments \
                '--shell+[Shell for which to return the completion script]:SHELL:(zsh)' \
            ;;
    esac
}

_nb_subcommands() {
    local commands; commands=(
        'new:Create a new note book' \
            'open:Open a note book' \
            'remove:Delete a note book' \
            'list:List existing note books' \
            'completions:Completion script for specific shell' \
        )
        _describe -t commands 'nb commands' commands "$@"
    }

_nb_notebooks() {
  [[ -d $NB_ROOT_DIR ]] || return 1

  local -a file_paths
  file_paths=($NB_ROOT_DIR/*(N))

  local -a file_names
  file_names=(${file_paths:t})
  _describe 'notebook' file_names
  # compadd -Q -a files
}
